<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
<meta name="generator" content="Jekyll v3.8.5">
<title>Checkout example Â· Bootstrap</title>

<link rel="canonical" href="https://getbootstrap.com/docs/4.3/examples/checkout/">
<link rel="stylesheet" href="/stylesheets/checkout.css">

<!-- Bootstrap core CSS -->
<link href="/docs/4.3/dist/css/bootstrap.min.css" rel="stylesheet"
	integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">


<style>
	.bd-placeholder-img {
		font-size: 1.125rem;
		text-anchor: middle;
		-webkit-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		user-select: none;
	}

	@media (min-width: 768px) {
		.bd-placeholder-img-lg {
			font-size: 3.5rem;
		}
	}
</style>
<!-- Custom styles for this template -->
<link href="form-validation.css" rel="stylesheet">
{{!-- body start --}}
<div class="container " style="margin-top: 10rem;">


	<div class="row">
		<div class="col-md-4 order-md-2 mb-4">
			<h4 class="d-flex justify-content-between align-items-center mb-3">
				<span class="text-muted">Your cart</span>
				<span class="badge badge-secondary badge-pill">{{cartCount}}</span>
			</h4>
			<ul class="list-group mb-3">
				{{#each products}}
				<li class="list-group-item d-flex justify-content-between lh-condensed">
					<div>
						<h6 class="my-0">{{this.product.Name}}</h6>
						<small class="text-muted">Brief description</small>
					</div>
					<span class="text-muted">Rs:{{this.product.Price}}</span>
				</li>
				{{/each}}
				<li class="list-group-item d-flex justify-content-between">
					<span>Total (INR)</span>
					<strong>Rs:{{total}}</strong>
				</li>
			</ul>

			<form class="card p-2">
				<div class="input-group">
					<input type="text" class="form-control" placeholder="Promo code">
					<div class="input-group-append">
						<button type="submit" class="btn btn-secondary">Redeem</button>
					</div>
				</div>
			</form>











		</div>
		{{#each address}}
		<div class="col-sm-6 mb-3">
			<div class="card">
				<div class="card-body">
					<h5 class="card-title">{{this.firstName}} {{this.lastName}}</h5>
					<p class="card-text">{{this.House}},{{this.Town}} -
						{{this.PIN}},',{{this.House}},{{this.Street}},{{this.Town}}<br></p>
					<button class="btn btn-success"
						onclick="autoFill('{{this.FirstName}}','{{this.LastName}}','{{this.House}}','{{this.Street}}','{{this.Town}}','{{this.PIN}}')">Auto
						Fill</button>
				</div>
			</div>
		</div>
		{{/each}}
		<div class="col-sm-6	 mb-5">
			<div class="card">
				<div class="card-body">

					<a href="/add-new-add" class="btn btn-success">Add New Address</a>
				</div>
			</div>
		</div>

		<div class="col-md-8 order-md-1">
			<h4 class="mb-3">Billing address</h4>

			<form id="checkout-form" method="post">
				<div class="row">
					<div class="col-sm-6 mb-3">
						<label for="firstName">First name</label>
						<input type="text" class="form-control" id="firstName" name="FirstName" placeholder="" value="">
						<div class="invalid-feedback">
							Valid first name is required.
						</div>
					</div>
					<div class="col-sm-6 mb-3">
						<label for="lastName">Last name</label>
						<input type="text" class="form-control" id="LastName" name="LastName" placeholder="" value="">
						<div class="invalid-feedback">
							Valid last name is required.
						</div>
					</div>
				</div>

				<div class="mb-3">
					<label for="House">House Name</label>
					<div class="input-group">

						<input type="text" class="form-control" id="House" name="House" placeholder="Username">
						<div class="invalid-feedback" style="width: 100%;">
							Your House is required.
						</div>
					</div>
				</div>

				<div class="mb-3">
					<label for="email">Street <span class="text-muted">(Optional)</span></label>
					<input type="text" class="form-control" id="Street" name="Street" placeholder="">
					<div class="invalid-feedback">
						Please enter a valid Street address for shipping updates.
					</div>
				</div>

				<div class="mb-3">
					<label for="address">Town</label>
					<input type="text" class="form-control" id="Town" name="Town" placeholder="1234 Main St">
					<div class="invalid-feedback">
						Please enter your shipping address.
					</div>
				</div>


				<div class="row">
					<div class="col-md-3 mb-3">
						<label for="Mobile">Mobile</label>
						<input type="number" class="form-control" id="Mobile" name="Mobile" placeholder="">
						<div class="invalid-feedback">
							Mobile Number is required
						</div>
					</div>
					<div class="col-md-3 mb-3">
						<label for="zip">PIN</label>
						<input type="number" class="form-control" id="PIN" name="PIN" placeholder="">
						<div class="invalid-feedback">
							PIN code required.
						</div>
					</div>


				<div class="col">

				

					<div class="form-check  ml-5">
						<input class="form-check-input" type="radio" name="Payment" value="COD">
						<label class="form-check-label" for="flexRadioDefault1">
							COD
						</label>
					</div>
					<div class="form-check ml-5">
						<input class="form-check-input" type="radio" name="Payment" id="Paypal" value="Paypal"
							checked>
						<label class="form-check-label" for="flexRadioDefault2">
							Paypal
						</label>
					</div>
					<div class="form-check ml-5">
						<input class="form-check-input" type="radio" name="Payment" id="Razorpay" value="Razorpay"
							checked>
						<label class="form-check-label" for="flexRadioDefault2">
							Razorpay
						</label>
					</div>
				</div>



					<div class="d-block my-3">
						<div class="custom-control custom-radio">
							<input id="User" name="User" type="text" value="{{user._id}}" class="custom-control-input"
								hidden>


						</div>

					</div>
				</div>
				<hr class="mb-4">






				<hr class="mb-4">
				<button id="submit" class="btn btn-primary btn-lg btn-block" type="submit">Continue to checkout</button>
			</form>
		</div>
	</div>
	{{!-- body end --}}
	<footer class="my-5 pt-5 text-muted text-center text-small">
		<p class="mb-1">&copy; 2017-2019 Company Name</p>
		<ul class="list-inline">
			<li class="list-inline-item"><a href="#">Privacy</a></li>
			<li class="list-inline-item"><a href="#">Terms</a></li>
			<li class="list-inline-item"><a href="#">Support</a></li>
		</ul>
	</footer>
</div>


<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
	function autoFill(fname, lname, house, street, town, pin) {
		Swal.fire({
			position: 'top-end',
			icon: 'success',
			title: 'Form auto filled',
			showConfirmButton: false,
			timer: 1500
		})
		document.getElementById('firstName').value = fname
		document.getElementById('LastName').value = lname
		document.getElementById('House').value = house
		document.getElementById('Street').value = street
		document.getElementById('Town').value = town
		document.getElementById('PIN').value = pin

	}
</script>


<script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
	crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/jquery.validate.js"></script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script>
	$('#checkout-form').submit((e) => {

		e.preventDefault()

		$.ajax({


			url: '/place-order',
			method: 'post',
			data: $('#checkout-form').serialize(),
			success: (response) => {


				if (response.codSuccess) {


					location.href = "/order-success"
				} else {


					razorpayPayment(response)

				}


			}
		})


	})

	function razorpayPayment(order) {



		var options = {

			"key": 'rzp_test_zWnKlXAtmeUJqs', // Enter the Key ID generated from the Dashboard
			"amount": order.amount, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
			"currency": "INR",
			"name": "E-BUY",
			"description": "Test Transaction",
			"image": "https://example.com/your_logo",
			"order_id": order.id, //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
			"handler": function (response) {
				verifyPayment(response, order)

			},
			"prefill": {
				"name": "Gaurav Kumar",
				"email": "gaurav.kumar@example.com",
				"contact": "9999999999"
			},
			"notes": {
				"address": "Razorpay Corporate Office"
			},
			"theme": {
				"color": "#3399cc"
			}
		};
		var rzp1 = new Razorpay(options)
		rzp1.open();

	}
	function verifyPayment(payment, order) {


		$.ajax({
			url: '/verify-Payment',
			data: {
				payment,
				order
			},
			method: 'post',
			success: (response) => {
				if (response.status) {
					location.href = "/order-success"
				} else {
					alert("payment failed")
				}
			}
		})
	}
</script>


<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
	integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
	crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="/docs/4.3/assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
<script src="https://getbootstrap.com/docs/4.3/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-xrRywqdh3PHs8keKZN+8zzc5TX0GRTLCcmivcbNJWm2rs5C8PRhcEn3czEjhAO9o"
	crossorigin="anonymous"></script>
<script src="https://getbootstrap.com/docs/4.3/examples/checkout/form-validation.js"></script>
</body>

</html>